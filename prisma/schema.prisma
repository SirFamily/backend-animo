// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mysql"
  url      = env("DATABASE_URL")
}

enum StatusBooking {
  CONFIRMED
  PENDING
  CANCELLED
}

model User {
  user_id        Int       @id @default(autoincrement())
  firstName      String
  lastName       String
  email          String    @unique
  password       String
  phone          String?
  identityNumber Int?
  address        String?
  city           String?
  district       String?
  img_profile    String?
  pets           Pet[]
  host           Host[]
  bookings        Booking[]
  Review         Review[]
}

model Pet {
  pet_id            Int                 @id @default(autoincrement())
  petName           String
  petType           String?
  birthDate         DateTime
  weight            Float?
  height            Float?
  color             String?
  gender            String?
  healthStatus      String?
  chipId            String?
  img_pet           String?
  owner             User                @relation(fields: [ownerId], references: [user_id])
  ownerId           Int
  pets_count_booking pet_count_booking[]
}

model Host {
  host_id      Int       @id @default(autoincrement())
  hostName     String
  location     String
  description  String?
  state        String
  publish      Boolean
  propertyType String
  user         User      @relation(fields: [hostUserId], references: [user_id])
  hostUserId   Int
  rooms        Room[]
  Bookings      Booking[]
}

model Room {
  room_id        Int              @id @default(autoincrement())
  roomName       String
  description    String?
  maximumAnimal  Int
  state          String
  host           Host             @relation(fields: [hostId], references: [host_id])
  hostId         Int
  rooms_img      Room_img[]
  rooms_amenities Room_amenities[]
  booking        Booking[]
}

model Room_img {
  room_img_id Int     @id @default(autoincrement())
  image       String?
  room        Room    @relation(fields: [roomId], references: [room_id])
  roomId      Int
}

model Room_amenities {
  room_amenities_id Int       @id @default(autoincrement())
  amenities         Amenities @relation(fields: [amenitiesId], references: [amens_id])
  amenitiesId       Int
  room              Room      @relation(fields: [roomId], references: [room_id])
  roomId            Int
}

model Amenities {
  amens_id       Int              @id @default(autoincrement())
  name           String
  imgIcon        String
  room_amenities Room_amenities[]
}

model Booking {
  booking_id        Int                 @id @default(autoincrement())
  checkInDate       DateTime
  checkOutDate      DateTime
  totalPrice        Float
  bookingDatetime   DateTime            @default(now())
  user              User                @relation(fields: [userId], references: [user_id])
  userId            Int
  host              Host                @relation(fields: [hostId], references: [host_id])
  hostId            Int
  room              Room                @relation(fields: [roomId], references: [room_id])
  roomId            Int
  pets_count_booking pet_count_booking[]
  booking_history  Bookings_history[]
  status_booking    Status_booking[]
}

model pet_count_booking {
  pet_bookings_id Int     @id @default(autoincrement())
  pet             Pet     @relation(fields: [petId], references: [pet_id])
  petId           Int
  booking         Booking @relation(fields: [bookingId], references: [booking_id])
  bookingId       Int
}

model Bookings_history {
  history_id       Int              @id @default(autoincrement())
  checkInDate      DateTime
  checkOutDate     DateTime
  totalPrice       Float
  bookingDatetime  DateTime         @default(now())
  checkOutDatetime DateTime?
  booking          Booking          @relation(fields: [bookingId], references: [booking_id])
  bookingId        Int
  status_booking   Status_booking[]
  review           Review[]
}

model Status_booking {
  status_booking_id  Int              @id @default(autoincrement())
  bookingStatus      StatusBooking    @default(PENDING)
  booking            Booking          @relation(fields: [bookingId], references: [booking_id])
  bookingId          Int
  bookings_history   Bookings_history @relation(fields: [bookings_historyId], references: [history_id])
  bookings_historyId Int
}

model Review {
  review_id         Int              @id @default(autoincrement())
  rating            String
  reviewText        String?
  datePosted        DateTime         @default(now())
  user              User             @relation(fields: [userId], references: [user_id])
  userId            Int
  bookings_history  Bookings_history @relation(fields: [bookingsHistoryId], references: [history_id])
  bookingsHistoryId Int
}
